# ระบบแปลงการจองเป็นคำขอยืม

## สรุป
ปรับปรุงระบบการจองอุปกรณ์ให้สามารถแปลงเป็นคำขอยืมได้ เมื่อผู้ใช้มารับอุปกรณ์ตามวันและเวลาที่จองไว้ Admin สามารถกดปุ่ม "แปลงเป็นคำขอยืม" เพื่อสร้างคำขอยืมโดยอัตโนมัติ

## การเปลี่ยนแปลง

### 1. เพิ่มฟิลด์ใหม่ในการจอง (Reservation)
- `expectedReturnDate` - วันที่คาดว่าจะคืนอุปกรณ์ (จำเป็นสำหรับการแปลงเป็นคำขอยืม)
- `convertedToLoanId` - ID ของคำขอยืมที่แปลงจากการจองนี้
- `convertedAt` - วันที่แปลงเป็นคำขอยืม

### 2. อัปเดตฟอร์มการจอง (ReservationForm)
- เพิ่มฟิลด์ "วันที่คาดว่าจะคืนอุปกรณ์" ให้ผู้ใช้กรอก
- Validation: วันที่คืนต้องไม่ก่อนวันที่จอง และไม่เกิน 30 วัน
- แสดงระยะเวลายืมอุปกรณ์

### 3. เพิ่มฟังก์ชัน convertToLoanRequest ใน ReservationService
- แปลงการจองที่มีสถานะ `approved` หรือ `ready` เป็นคำขอยืม
- สร้างคำขอยืมใหม่และอนุมัติโดยอัตโนมัติ
- อัปเดตสถานะการจองเป็น `completed`
- ส่งการแจ้งเตือนไปยังผู้ใช้และ Discord

### 4. อัปเดตหน้าจัดการการจอง (AdminReservationManagement)
- เพิ่มปุ่ม "แปลงเป็นคำขอยืม" สำหรับการจองที่อนุมัติแล้ว
- แสดง badge "แปลงแล้ว" สำหรับการจองที่ถูกแปลงแล้ว
- แสดงข้อมูลวันที่คาดว่าจะคืนใน Modal รายละเอียด

## Flow การใช้งาน

```
1. ผู้ใช้สร้างการจอง
   - กรอกข้อมูล: อุปกรณ์, วันที่จอง, เวลา, วันที่คาดว่าจะคืน, วัตถุประสงค์
   
2. Admin อนุมัติการจอง
   - สถานะเปลี่ยนเป็น "approved" หรือ "ready"
   
3. ผู้ใช้มารับอุปกรณ์
   - Admin กดปุ่ม "แปลงเป็นคำขอยืม"
   
4. ระบบสร้างคำขอยืมอัตโนมัติ
   - ใช้ข้อมูลจากการจอง (equipmentId, userId, purpose, expectedReturnDate)
   - คำขอยืมถูกอนุมัติโดยอัตโนมัติ
   - การจองเปลี่ยนสถานะเป็น "completed"
   
5. ผู้ใช้ได้รับการแจ้งเตือน
   - แจ้งว่าการจองถูกแปลงเป็นคำขอยืมแล้ว
```

## ไฟล์ที่แก้ไข
- `src/types/reservation.js` - เพิ่ม type definitions
- `src/services/reservationService.js` - เพิ่มฟังก์ชัน convertToLoanRequest
- `src/components/reservations/ReservationForm.js` - เพิ่มฟิลด์ expectedReturnDate
- `src/components/admin/AdminReservationManagement.js` - เพิ่มปุ่มและ UI

## หมายเหตุ
- การจองที่ถูกแปลงแล้วจะไม่สามารถแปลงซ้ำได้
- คำขอยืมที่สร้างจากการจองจะถูกอนุมัติโดยอัตโนมัติ
- ข้อมูล notes จะถูกเพิ่มข้อความ "แปลงจากการจอง #xxx"
