# การสร้างหน้า Equipment สำหรับ User ใหม่

## วันที่: 2025-11-24

## ปัญหา
หน้า Equipment ของ User ไม่แสดงผลอย่างถูกต้อง

## วิธีแก้ไข
ลบและสร้างหน้า Equipment ใหม่โดยอ้างอิงจากหน้า Admin Equipment แต่ตัดฟีเจอร์การจัดการออก

## การเปลี่ยนแปลง

### ไฟล์ที่แก้ไข
- `src/components/EquipmentPage.js` - สร้างใหม่ทั้งหมด

### ฟีเจอร์ที่เหลือสำหรับ User
1. **ดูรายการอุปกรณ์** - แสดงรายการอุปกรณ์ทั้งหมด
2. **ค้นหาและกรอง** - ค้นหาตามชื่อ, ยี่ห้อ, รุ่น, หมายเลข และกรองตามประเภทและสถานะ
3. **ดูรายละเอียด** - ดูข้อมูลอุปกรณ์แบบละเอียด
4. **ยืมอุปกรณ์** - สำหรับอุปกรณ์ที่สถานะ "พร้อมใช้งาน"
5. **จองอุปกรณ์** - สำหรับอุปกรณ์ที่สถานะ "พร้อมใช้งาน"
6. **Pagination** - แบ่งหน้าแสดงผล 5 รายการต่อหน้า

### ฟีเจอร์ที่ถูกตัดออก (Admin เท่านั้น)
- ❌ เพิ่มอุปกรณ์
- ❌ แก้ไขอุปกรณ์
- ❌ ลบอุปกรณ์
- ❌ Refresh Token (สำหรับ permission error)

## โครงสร้างหน้า

### 1. Header
- ชื่อหน้า: "รายการอุปกรณ์"
- คำอธิบาย: "ดูรายการอุปกรณ์ที่พร้อมให้บริการ"

### 2. Search & Filters
- ช่องค้นหา (ค้นหาชื่อ, ยี่ห้อ, รุ่น, หมายเลข)
- กรองตามประเภท (Category)
- กรองตามสถานะ (available, borrowed, maintenance)
- แสดงตัวกรองที่ใช้งานอยู่
- ปุ่มล้างตัวกรอง

### 3. Equipment Cards
แต่ละการ์ดแสดง:
- รูปภาพอุปกรณ์ (พร้อม badge จำนวนรูป)
- ชื่ออุปกรณ์
- Status Badge
- ยี่ห้อ
- รุ่น
- หมายเลขอุปกรณ์
- สถานที่
- ปุ่มดำเนินการ:
  - **ดูรายละเอียด** (ทุกสถานะ)
  - **ยืม** (เฉพาะสถานะ available)
  - **จอง** (เฉพาะสถานะ available)

### 4. Pagination
- แสดง 5 รายการต่อหน้า
- ปุ่มก่อนหน้า/ถัดไป
- เลขหน้า (แสดงหน้าปัจจุบัน ± 1 และหน้าแรก/สุดท้าย)
- แสดงจำนวนรายการที่แสดง

## การทำงานของปุ่ม

### ดูรายละเอียด
```javascript
const handleViewDetails = (item) => {
  // TODO: Navigate to equipment detail page or open modal
  console.log('View details:', item);
  alert(`ดูรายละเอียด: ${item.name}\n\nฟีเจอร์นี้จะพัฒนาในอนาคต`);
};
```

### ยืม
```javascript
const handleBorrow = (item) => {
  // TODO: Navigate to borrow request page
  console.log('Borrow:', item);
  alert(`ยืมอุปกรณ์: ${item.name}\n\nฟีเจอร์นี้จะพัฒนาในอนาคต`);
};
```

### จอง
```javascript
const handleReserve = (item) => {
  // TODO: Navigate to reservation page
  console.log('Reserve:', item);
  alert(`จองอุปกรณ์: ${item.name}\n\nฟีเจอร์นี้จะพัฒนาในอนาคต`);
};
```

## Dependencies ที่ใช้

### Services
- `EquipmentManagementService` - โหลดข้อมูลอุปกรณ์
- `EquipmentCategoryService` - โหลดประเภทอุปกรณ์

### Utils
- `getCategoryId` - แปลง category เป็น ID

### Components
- `Layout` - Layout หลัก
- `LoadingSpinner` - แสดงสถานะกำลังโหลด
- `EmptyState` - แสดงเมื่อไม่มีข้อมูล
- `EquipmentStatusBadge` - แสดง badge สถานะ

## State Management

### Equipment Data
- `equipment` - รายการอุปกรณ์ทั้งหมด
- `loading` - สถานะกำลังโหลด
- `error` - ข้อความ error
- `categories` - รายการประเภทอุปกรณ์

### Filters
- `searchTerm` - คำค้นหา
- `selectedCategory` - ประเภทที่เลือก
- `selectedStatus` - สถานะที่เลือก

### Pagination
- `currentPage` - หน้าปัจจุบัน
- `itemsPerPage` - จำนวนรายการต่อหน้า (5)

## Performance Optimization

### useMemo
- `filteredEquipment` - คำนวณรายการที่กรองแล้ว
- `paginatedEquipment` - คำนวณรายการในหน้าปัจจุบัน
- `totalPages` - คำนวณจำนวนหน้าทั้งหมด

### useCallback
- `loadEquipment` - โหลดข้อมูลอุปกรณ์
- `handleClearFilters` - ล้างตัวกรอง
- `handlePreviousPage` - ไปหน้าก่อนหน้า
- `handleNextPage` - ไปหน้าถัดไป
- `handlePageClick` - ไปหน้าที่เลือก

## การทดสอบ

### ทดสอบการแสดงผล
1. เข้าหน้า Equipment
2. ตรวจสอบว่าแสดงรายการอุปกรณ์
3. ตรวจสอบว่ารูปภาพแสดงถูกต้อง
4. ตรวจสอบว่า status badge แสดงถูกต้อง

### ทดสอบการค้นหา
1. พิมพ์คำค้นหา
2. ตรวจสอบว่ารายการกรองถูกต้อง
3. ตรวจสอบว่าแสดงจำนวนรายการที่ถูกต้อง

### ทดสอบการกรอง
1. เลือกประเภท
2. เลือกสถานะ
3. ตรวจสอบว่ารายการกรองถูกต้อง
4. คลิกล้างตัวกรอง

### ทดสอบ Pagination
1. ตรวจสอบว่าแสดง 5 รายการต่อหน้า
2. คลิกหน้าถัดไป
3. คลิกหน้าก่อนหน้า
4. คลิกเลขหน้า

### ทดสอบปุ่มดำเนินการ
1. คลิก "ดูรายละเอียด" - ควรแสดง alert
2. คลิก "ยืม" (เฉพาะ available) - ควรแสดง alert
3. คลิก "จอง" (เฉพาะ available) - ควรแสดง alert

## งานที่ต้องทำต่อ (TODO)

### 1. Equipment Detail Page
- สร้างหน้าแสดงรายละเอียดอุปกรณ์
- แสดงรูปภาพทั้งหมด (gallery)
- แสดงข้อมูลเต็ม
- แสดงประวัติการยืม

### 2. Borrow Request Page
- สร้างฟอร์มขอยืมอุปกรณ์
- เลือกวันที่ยืม-คืน
- ระบุเหตุผลการยืม
- ส่งคำขอยืม

### 3. Reservation Page
- สร้างฟอร์มจองอุปกรณ์
- เลือกวันที่จอง
- ระบุเหตุผลการจอง
- ส่งคำขอจอง

### 4. Integration
- เชื่อมต่อปุ่ม "ดูรายละเอียด" กับหน้า detail
- เชื่อมต่อปุ่ม "ยืม" กับฟอร์มขอยืม
- เชื่อมต่อปุ่ม "จอง" กับฟอร์มจอง

## สรุป
สร้างหน้า Equipment สำหรับ User ใหม่สำเร็จ โดยอ้างอิงจากหน้า Admin แต่ตัดฟีเจอร์การจัดการออก เหลือเฉพาะฟีเจอร์ที่ User ใช้งาน (ดูรายละเอียด, ยืม, จอง) พร้อมระบบค้นหา กรอง และ pagination ที่สมบูรณ์
