# тЪЩя╕П р╕Ыр╕гр╕░р╕зр╕▒р╕Хр╕┤р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В тАФ р╕гр╕░р╕Ър╕Ър╕Ир╕▒р╕Фр╕Бр╕▓р╕г (Admin & Staff)

р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕З Admin Dashboard, Settings, Reports, Staff Activity р╣Бр╕ер╕░ Data Management

---

## р╕Шр╕▒р╕Щр╕зр╕▓р╕Др╕б 2568

### тЬи Admin Dashboard
**р╣Др╕Яр╕ер╣Мр╕лр╕ер╕▒р╕Б:** `app/admin/page.tsx`  
**р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф:**
- р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕гр╕╕р╕Ы (р╕Ир╕│р╕Щр╕зр╕Щр╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣М, р╕Др╕│р╕Вр╕нр╕гр╕нр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕г, р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й)
- р╕Бр╕гр╕▓р╕Яр╕кр╕Цр╕┤р╕Хр╕┤р╕Бр╕▓р╕гр╕вр╕╖р╕б-р╕Др╕╖р╕Щ
- р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Др╕│р╕Вр╕нр╕ер╣Ир╕▓р╕кр╕╕р╕Ф
- Quick actions р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Зр╕▓р╕Щр╕Чр╕╡р╣Ир╕Чр╕│р╕Ър╣Ир╕нр╕в

### тЬи р╕гр╕░р╕Ър╕Ър╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ (System Config)
**Migration:** `20251226_system_config.sql`, `20251230_enhanced_system_config.sql`  
**р╣Др╕Яр╕ер╣Мр╕лр╕ер╕▒р╕Б:** `app/admin/settings/`  
**р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф:**
- р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕вр╕░р╣Ар╕зр╕ер╕▓р╕вр╕╖р╕бр╕кр╕╣р╕Зр╕кр╕╕р╕Ф
- р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Ир╕│р╕Щр╕зр╕Щр╕зр╕▒р╕Щр╕Ир╕нр╕Зр╕ер╣Ир╕зр╕Зр╕лр╕Щр╣Йр╕▓
- р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Discord Webhook URL
- р╣Ар╕Ыр╕┤р╕Ф/р╕Ыр╕┤р╕Фр╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╕Хр╣Ир╕▓р╕Зр╣Ж

### тЬи р╕гр╕░р╕Ър╕Ър╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
**р╣Др╕Яр╕ер╣Мр╕лр╕ер╕▒р╕Б:** `app/admin/users/`  
**р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф:**
- р╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤/р╕Ыр╕Пр╕┤р╣Ар╕кр╕Ш/р╕гр╕░р╕Зр╕▒р╕Ъ р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
- р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Ър╕Чр╕Ър╕▓р╕Ч (user тЖТ staff тЖТ admin)
- р╕ер╕Ър╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й (р╕Юр╕гр╣Йр╕нр╕бр╕Ир╕▒р╕Фр╕Бр╕▓р╕г FK constraints)
- р╕Фр╕╣р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕ер╕░р╕Ыр╕гр╕░р╕зр╕▒р╕Хр╕┤р╕Вр╕нр╕Зр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Бр╕Хр╣Ир╕ер╕░р╕Др╕Щ

---

## р╕бр╕Бр╕гр╕▓р╕Др╕б 2569

### тЬи Staff Dashboard
**р╣Др╕Яр╕ер╣Мр╕лр╕ер╕▒р╕Б:** `app/staff/page.tsx`  
**р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф:**
- Dashboard р╣Ар╕Йр╕Юр╕▓р╕░ Staff р╣Бр╕вр╕Бр╕Ир╕▓р╕Б Admin
- р╣Бр╕кр╕Фр╕Зр╕Др╕│р╕Вр╕нр╕гр╕нр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕г
- Quick actions: р╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤, р╕Ыр╕Пр╕┤р╣Ар╕кр╕Ш, р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╕Др╕╖р╕Щ
- р╕Фр╕╣р╕гр╕▓р╕вр╕Бр╕▓р╕гр╣Ар╕Бр╕┤р╕Щр╕Бр╕│р╕лр╕Щр╕Ф

### тЬи р╕гр╕░р╕Ър╕Ър╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б Staff
**р╣Др╕Яр╕ер╣Мр╕лр╕ер╕▒р╕Б:** `app/admin/staff-activity/`, `lib/staffActivityLog.ts`  
**р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф:**
- р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Чр╕╕р╕Бр╕Бр╕▓р╕гр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╕Вр╕нр╕З Staff (р╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤, р╕Ыр╕Пр╕┤р╣Ар╕кр╕Ш, р╕Др╕╖р╕Щ)
- Admin р╕Фр╕╣р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕Вр╕нр╕З Staff р╣Бр╕Хр╣Ир╕ер╕░р╕Др╕Щ
- р╕Бр╕гр╕нр╕Зр╕Хр╕▓р╕бр╕Кр╣Ир╕зр╕Зр╣Ар╕зр╕ер╕▓р╣Бр╕ер╕░р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б

### тЬи р╕гр╕░р╕Ър╕Ъ Data Management
**Migration:** `20260120_data_management.sql`  
**р╣Др╕Яр╕ер╣Мр╕лр╕ер╕▒р╕Б:** `app/admin/data-management/`  
**р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф:**
- Import/Export р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣М
- р╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╣Ир╕зр╕Щр╕кр╕│р╕Др╕▒р╕Н
- р╕ер╣Йр╕▓р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓ (notifications, logs)

### тЬи р╕гр╕░р╕Ър╕Ър╕нр╕нр╕Бр╣Ар╕нр╕Бр╕кр╕▓р╕г
**Migration:** `20260121_add_document_logo.sql`, `20260122_add_document_template.sql`  
**р╣Др╕Яр╕ер╣Мр╕лр╕ер╕▒р╕Б:** `lib/docxGenerator.ts`  
**р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф:**
- р╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕нр╕Бр╕кр╕▓р╕г PDF/DOCX р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Гр╕Ър╕вр╕╖р╕б-р╕Др╕╖р╕Щ
- р╣Гр╕кр╣Ир╣Вр╕ер╣Вр╕Бр╣Йр╕лр╕Щр╣Ир╕зр╕вр╕Зр╕▓р╕Щ
- р╕гр╕нр╕Зр╕гр╕▒р╕Ъ template р╕Чр╕╡р╣Ир╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕Зр╣Др╕Фр╣Й

### тЬи р╕гр╕░р╕Ър╕Ъ Support Chat
**Migration:** `20260127_support_chat.sql`, `20260127_fix_support_chat_fk.sql`  
**р╣Др╕Яр╕ер╣Мр╕лр╕ер╕▒р╕Б:** `app/admin/support/`  
**р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф:**
- р╕гр╕░р╕Ър╕Ър╣Бр╕Кр╕Чр╕кр╕│р╕лр╕гр╕▒р╕Ъ support р╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Бр╕▒р╕Ъ admin
- Read receipts

---

## р╕Бр╕╕р╕бр╕ар╕▓р╕Юр╕▒р╕Щр╕Шр╣М 2569

### тЪб р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕З Performance
**Migration:** `20260206_optimize_indexes.sql`, `20260203_add_missing_indexes.sql`  
**р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф:**
- р╣Ар╕Юр╕┤р╣Ир╕б composite indexes р╕кр╕│р╕лр╕гр╕▒р╕Ъ query р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕Ър╣Ир╕нр╕в
- р╕ер╕Фр╣Ар╕зр╕ер╕▓ loading р╕Вр╕нр╕З Dashboard
- р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕З RLS р╣Гр╕лр╣Й lightweight р╕бр╕▓р╕Бр╕Вр╕╢р╣Йр╕Щ

### тЬи Theme Switcher
**р╣Др╕Яр╕ер╣Мр╕лр╕ер╕▒р╕Б:** `app/admin/settings/`  
**р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф:**
- р╣Ар╕Юр╕┤р╣Ир╕бр╕Хр╕▒р╕зр╣Ар╕ер╕╖р╕нр╕Б theme р╣Гр╕Щр╕лр╕Щр╣Йр╕▓ Settings
- р╕гр╕нр╕Зр╕гр╕▒р╕Ъ 2 themes: Playful р╣Бр╕ер╕░ Brutalist Minimal
- р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Др╣Ир╕▓р╕ер╕З system_config

### тЬи р╕гр╕░р╕Ър╕Ър╕гр╕▓р╕вр╕Зр╕▓р╕Щ
**р╣Др╕Яр╕ер╣Мр╕лр╕ер╕▒р╕Б:** `app/admin/reports/`, `lib/reports.ts`, `lib/reportDataProcessors.ts`  
**р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф:**
- р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕кр╕Цр╕┤р╕Хр╕┤р╕Бр╕▓р╕гр╕вр╕╖р╕б (р╕гр╕▓р╕вр╕зр╕▒р╕Щ/р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М/р╣Ар╕Фр╕╖р╕нр╕Щ)
- р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣Мр╕Чр╕╡р╣Ир╕вр╕╖р╕бр╕Ър╣Ир╕нр╕в / р╕вр╕╖р╕бр╕Щр╣Йр╕нр╕в
- р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Хр╕▓р╕бр╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣И
- р╕Бр╕гр╕▓р╕Яр╣Бр╕кр╕Фр╕Зр╣Бр╕Щр╕зр╣Вр╕Щр╣Йр╕б

### ЁЯРЫ р╣Бр╕Бр╣Йр╣Др╕В Admin Settings Timeout
**Migration:** `20260210_fix_all_rls_timeouts.sql`  
**р╕Ыр╕▒р╕Нр╕лр╕▓:** р╕лр╕Щр╣Йр╕▓ Admin Settings р╣Вр╕лр╕ер╕Фр╕Кр╣Йр╕▓/timeout  
**р╕кр╕▓р╣Ар╕лр╕Хр╕╕:** RLS policy р╕Вр╕нр╕З `system_config` р╕Кр╣Йр╕▓р╣Ар╕Юр╕гр╕▓р╕░ recursive query  
**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й:** р╣Гр╕Кр╣Й security definer function р╣Бр╕Чр╕Щ inline RLS check

### ЁЯРЫ р╣Бр╕Бр╣Йр╣Др╕В Staff Activity Log р╣Др╕бр╣Ир╕Ър╕▒р╕Щр╕Чр╕╢р╕Б
**р╕Ыр╕▒р╕Нр╕лр╕▓:** р╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б loan/return р╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Гр╕Щр╕Хр╕▓р╕гр╕▓р╕З `staff_activity_log`  
**р╕кр╕▓р╣Ар╕лр╕Хр╕╕:** Server Actions р╣Др╕бр╣Ир╣Др╕Фр╣Йр╣Ар╕гр╕╡р╕вр╕Б `logStaffActivity()`  
**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й:** р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Б `logStaffActivity()` р╣Гр╕Щ `approveLoan`, `rejectLoan`, `markReturned`

### тЬи р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Гр╕Щр╣Бр╕нр╕Ы
**р╣Др╕Яр╕ер╣Мр╕лр╕ер╕▒р╕Б:** `app/user-guide/`, `app/admin/manual/`, `app/staff/manual/`  
**р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф:** р╣Ар╕Юр╕┤р╣Ир╕бр╕лр╕Щр╣Йр╕▓р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕ар╕▓р╕вр╣Гр╕Щр╣Бр╕нр╕Ы р╣Бр╕вр╕Бр╕Хр╕▓р╕бр╕Ър╕Чр╕Ър╕▓р╕Ч

### тЬи р╕ер╕Ър╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣М QR Code
**р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф:** р╕ер╕Ъ QR code scanning р╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕гр╕░р╕Ър╕Ър╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф (р╣Вр╕Др╣Йр╕Ф, р╣Ар╕нр╕Бр╕кр╕▓р╕г, р╕Др╕╣р╣Ир╕бр╕╖р╕н) р╣Ар╕Юр╕гр╕▓р╕░р╣Др╕бр╣Ир╣Др╕Фр╣Йр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

---

## р╕лр╕Щр╣Йр╕▓р╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕Ир╕▒р╕Фр╕Бр╕▓р╕г

### Admin Pages
| р╣Ар╕бр╕Щр╕╣ | р╣Ар╕кр╣Йр╕Щр╕Чр╕▓р╕З | р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в |
|------|---------|----------|
| Dashboard | `/admin` | р╕ар╕▓р╕Юр╕гр╕зр╕бр╕гр╕░р╕Ър╕Ъ |
| Users | `/admin/users` | р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й |
| Equipment | `/admin/equipment` | р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣М |
| Equipment Types | `/admin/equipment-types` | р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╣Ар╕ар╕Ч |
| Loans | `/admin/loans` | р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Др╕│р╕Вр╕нр╕вр╕╖р╕б |
| Returns | `/admin/returns` | р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Бр╕▓р╕гр╕Др╕╖р╕Щ |
| Reservations | `/admin/reservations` | р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Бр╕▓р╕гр╕Ир╕нр╕З |
| Special Loans | `/admin/special-loans` | р╕вр╕╖р╕бр╕Юр╕┤р╣Ар╕ир╕й |
| Reports | `/admin/reports` | р╕гр╕▓р╕вр╕Зр╕▓р╕Щ |
| Evaluations | `/admin/evaluations` | р╣Бр╕Ър╕Ър╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щ |
| Staff Activity | `/admin/staff-activity` | р╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б Staff |
| Settings | `/admin/settings` | р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕Ър╕Ъ |
| Data Management | `/admin/data-management` | р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕е |
| Support | `/admin/support` | р╣Бр╕Кр╕Ч support |

### Staff Pages
| р╣Ар╕бр╕Щр╕╣ | р╣Ар╕кр╣Йр╕Щр╕Чр╕▓р╕З | р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в |
|------|---------|----------|
| Dashboard | `/staff` | р╕ар╕▓р╕Юр╕гр╕зр╕бр╕Зр╕▓р╕Щ |
| Loans | `/staff/loans` | р╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤/р╕Ыр╕Пр╕┤р╣Ар╕кр╕Ш |
| Returns | `/staff/returns` | р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╕Др╕╖р╕Щ |
| Overdue | `/staff/overdue` | р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Ар╕Бр╕┤р╕Щр╕Бр╕│р╕лр╕Щр╕Ф |
| Reservations | `/staff/reservations` | р╕Фр╕╣р╕Бр╕▓р╕гр╕Ир╕нр╕З |

---

## р╕Ър╕Чр╣Ар╕гр╕╡р╕вр╕Щр╕кр╕│р╕Др╕▒р╕Н

> **Server Actions р╕Хр╣Йр╕нр╕Зр╕Ър╕▒р╕Щр╕Чр╕╢р╕Б activity log** тАФ р╕Чр╕╕р╕Б mutation р╕Чр╕╡р╣И Staff/Admin р╕Чр╕│р╕Хр╣Йр╕нр╕Зр╣Ар╕гр╕╡р╕вр╕Б logStaffActivity()

> **RLS timeout р╣Ар╕Ыр╣Зр╕Щр╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣Ир╕Юр╕Ър╕Ър╣Ир╕нр╕в** тАФ р╣Гр╕Кр╣Й security definer functions р╕кр╕│р╕лр╕гр╕▒р╕Ъ complex checks

> **р╕ер╕Ър╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╣Гр╕Кр╣Йр╕нр╕нр╕Б** тАФ QR Code р╕Чр╕╡р╣Ир╣Др╕бр╣Ир╣Др╕Фр╣Йр╣Гр╕Кр╣Йр╕Чр╕│р╣Гр╕лр╣Йр╣Ар╕нр╕Бр╕кр╕▓р╕гр╣Бр╕ер╕░р╣Вр╕Др╣Йр╕Фр╕кр╕▒р╕Ър╕кр╕Щ
