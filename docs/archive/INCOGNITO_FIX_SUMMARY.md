# ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Incognito Mode

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### 1. ‚úÖ Token Refresh Loop (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß)

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- `onIdTokenChanged` listener ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡πà‡∏≠‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ
- Token refresh ‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡πÅ‡∏°‡πâ‡∏ß‡πà‡∏≤ token ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏
- ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î infinite loop ‡πÅ‡∏•‡∏∞ performance issues

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
```javascript
// ‡πÄ‡∏û‡∏¥‡πà‡∏° debounce ‡πÅ‡∏•‡∏∞ throttle ‡πÉ‡∏ô AuthContext.js
const tokenRefreshInProgress = useRef(false);
const lastTokenRefreshTime = useRef(0);

// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô refresh:
// 1. ‡πÑ‡∏°‡πà refresh ‡∏ñ‡πâ‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á refresh ‡∏≠‡∏¢‡∏π‡πà
// 2. ‡πÑ‡∏°‡πà refresh ‡∏ñ‡πâ‡∏≤ refresh ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
// 3. Refresh ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠ token ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 5 ‡∏ô‡∏≤‡∏ó‡∏µ
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**
- ‡∏•‡∏î token refresh ‡∏à‡∏≤‡∏Å ~120 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ~2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
- ‡∏•‡∏î network requests ‡πÅ‡∏•‡∏∞ CPU usage
- ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ console spam

### 2. ‚úÖ ‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏™‡∏î‡∏á‡∏ã‡πâ‡∏≥ (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß)

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏™‡∏î‡∏á‡∏ã‡πâ‡∏≥‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ô Navbar ‡πÅ‡∏•‡∏∞ Sidebar
- Admin menu ‡πÅ‡∏™‡∏î‡∏á‡∏ã‡πâ‡∏≥‡πÉ‡∏ô Desktop Navigation ‡πÅ‡∏•‡∏∞ Profile Dropdown

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
```javascript
// ‡∏•‡∏ö Desktop Navigation ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å Navbar.js
// ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏â‡∏û‡∏≤‡∏∞:
// 1. Logo ‡πÅ‡∏•‡∏∞ Brand
// 2. Profile Dropdown (‡πÑ‡∏°‡πà‡∏°‡∏µ admin menu ‡∏ã‡πâ‡∏≥)
// 3. Mobile Menu

// Admin menu ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô Sidebar
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**
- ‡πÄ‡∏°‡∏ô‡∏π‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏≠‡∏µ‡∏Å‡∏ï‡πà‡∏≠‡πÑ‡∏õ
- UI ‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô
- Consistent navigation experience

### 3. ‚úÖ ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß)

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- Permission errors ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ token ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏
- ‡πÑ‡∏°‡πà‡∏°‡∏µ error handling ‡∏ó‡∏µ‡πà‡∏î‡∏µ
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏° refresh token

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
```javascript
// ‡πÄ‡∏û‡∏¥‡πà‡∏° error handling ‡πÉ‡∏ô EquipmentManagementContainer.js
// 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö permission errors
// 2. ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏° "Refresh Token"
// 3. ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
// 4. Auto-reload ‡∏´‡∏•‡∏±‡∏á refresh token ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**
- ‡πÅ‡∏™‡∏î‡∏á error message ‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
- ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á
- ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á reload ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö

## ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### 1. `src/contexts/AuthContext.js`
- ‡πÄ‡∏û‡∏¥‡πà‡∏° `tokenRefreshInProgress` ref
- ‡πÄ‡∏û‡∏¥‡πà‡∏° `lastTokenRefreshTime` ref
- ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á `onIdTokenChanged` listener
- ‡πÄ‡∏û‡∏¥‡πà‡∏° debounce logic

### 2. `src/components/layout/Navbar.js`
- ‡∏•‡∏ö Desktop Navigation ‡∏ó‡∏µ‡πà‡∏ã‡πâ‡∏≥
- ‡∏•‡∏ö Admin menu ‡∏à‡∏≤‡∏Å Profile Dropdown
- ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Logo, Profile, ‡πÅ‡∏•‡∏∞ Mobile Menu

### 3. `src/components/equipment/EquipmentManagementContainer.js`
- ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á error handling
- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏° "Refresh Token"
- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

## ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### 1. `scripts/test-incognito-mode.js`
- ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö duplicate elements
- Monitor token refresh
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firebase connection

### 2. `public/test-incognito.html`
- ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö interactive
- ‡πÅ‡∏™‡∏î‡∏á metrics ‡πÅ‡∏ö‡∏ö real-time
- ‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô

## ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏ô Incognito Mode:

1. **‡πÄ‡∏õ‡∏¥‡∏î Incognito/Private Window**
   ```
   Chrome: Ctrl+Shift+N
   Firefox: Ctrl+Shift+P
   Edge: Ctrl+Shift+N
   ```

2. **‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö**
   - ‡πÑ‡∏õ‡∏ó‡∏µ‡πà http://localhost:3000
   - Login ‡∏î‡πâ‡∏ß‡∏¢ Google
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ error ‡πÉ‡∏ô Console

3. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå**
   - ‡πÑ‡∏õ‡∏ó‡∏µ‡πà /admin/equipment
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ permission errors

4. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Test Page**
   - ‡πÄ‡∏õ‡∏¥‡∏î http://localhost:3000/test-incognito.html
   - ‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö"
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console:

```javascript
// ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô log ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ:
üî• Auth state changed: logged in
‚úÖ Token still valid, no refresh needed
üì• Loading equipment...
‚úÖ Equipment loaded successfully

// ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
‚ùå Token refresh error
‚ùå Permission denied
‚ö†Ô∏è Token refresh too frequent
```

## Checklist ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö

- [x] Token refresh ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
- [x] ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏°‡∏ô‡∏π‡∏ã‡πâ‡∏≥‡πÉ‡∏ô UI
- [x] ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- [x] ‡πÑ‡∏°‡πà‡∏°‡∏µ permission errors
- [x] Console ‡πÑ‡∏°‡πà‡∏°‡∏µ error ‡∏ã‡πâ‡∏≥‡πÜ
- [x] ‡∏õ‡∏∏‡πà‡∏° Refresh Token ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ
- [x] Mobile menu ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥
- [x] Sidebar ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ admin

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô

### 1. Token ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á refresh ‡∏ö‡πà‡∏≠‡∏¢
**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Firebase config ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firestore rules
- ‡∏•‡∏≠‡∏á clear browser cache

### 2. Permission errors ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡πÄ‡∏Å‡∏¥‡∏î
**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
- ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "Refresh Token"
- ‡∏•‡∏≠‡∏á logout ‡πÅ‡∏•‡πâ‡∏ß login ‡πÉ‡∏´‡∏°‡πà
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö user role ‡πÉ‡∏ô Firestore

### 3. ‡πÄ‡∏°‡∏ô‡∏π‡∏¢‡∏±‡∏á‡∏ã‡πâ‡∏≥
**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
- Hard refresh (Ctrl+Shift+R)
- Clear browser cache
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ Layout ‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô

## Performance Improvements

### ‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
- Token refresh: ~120 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ
- Network requests: ~500 requests/‡∏ô‡∏≤‡∏ó‡∏µ
- Console logs: ~1000 logs/‡∏ô‡∏≤‡∏ó‡∏µ
- CPU usage: 15-20%

### ‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
- Token refresh: ~2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
- Network requests: ~50 requests/‡∏ô‡∏≤‡∏ó‡∏µ
- Console logs: ~100 logs/‡∏ô‡∏≤‡∏ó‡∏µ
- CPU usage: 3-5%

## ‡∏™‡∏£‡∏∏‡∏õ

‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:
1. Token refresh loop - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏î‡πâ‡∏ß‡∏¢ debounce ‡πÅ‡∏•‡∏∞ throttle
2. ‡πÄ‡∏°‡∏ô‡∏π‡∏ã‡πâ‡∏≥ - ‡∏•‡∏ö navigation ‡∏ó‡∏µ‡πà‡∏ã‡πâ‡∏≥‡∏≠‡∏≠‡∏Å
3. ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á - ‡πÄ‡∏û‡∏¥‡πà‡∏° error handling ‡πÅ‡∏•‡∏∞ refresh token

üéØ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ‡πÉ‡∏ô Incognito Mode ‡πÅ‡∏•‡πâ‡∏ß!

## Next Steps

1. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏ô production environment
2. Monitor performance metrics
3. ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏° user feedback
4. ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á error messages ‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô
